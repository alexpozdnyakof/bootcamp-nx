import { useEffect, useState } from 'react'
import {
	Meta,
	Story,
	Canvas,
	ArgsTable,
	Description,
} from '@storybook/addon-docs'
import Button from './button'
import { Box } from '../box'
import { Inline } from '../inline'
import { Stack } from '../stack'
import { Text } from '../text'
import { Heading } from '../heading'

<Meta
	title='Design system/Button'
	component={Button}
	parameters={{
		badges: ['accessible'],
	}}
/>

# Button

Basic button component

<Canvas>
	<Story parameters={{ docs: { source: { type: 'code' } } }} name='Overview'>
		<Stack space='xxlarge'>
			<Stack space='large'>
				<Inline space='large'>
					<Box>
						<Button variant='primary'>Primary action</Button>
					</Box>
					<Box>
						<Button variant='secondary'>Secondary action</Button>
					</Box>
					<Box>
						<Button variant='tertiary'>Tertiary action</Button>
					</Box>
					<Box>
						<Button variant='quaternary'>Quaternary action</Button>
					</Box>
				</Inline>
				<Inline space='large'>
					<Box>
						<Button variant='primary' disabled>
							Primary action
						</Button>
					</Box>
					<Box>
						<Button variant='secondary' disabled>
							Secondary action
						</Button>
					</Box>
					<Box>
						<Button variant='tertiary' disabled>
							Tertiary action
						</Button>
					</Box>
					<Box>
						<Button variant='quaternary' disabled>
							Quaternary action
						</Button>
					</Box>
				</Inline>
			</Stack>
		</Stack>
	</Story>
</Canvas>

### Size

Button have 3 sizes

<Canvas>
	<Story
		parameters={{ docs: { source: { type: 'code' } } }}
		name='Size scale'
	>
		<Stack space='xxlarge'>
			<Stack space='large'>
				<p>Small button</p>
				<Inline space='large'>
					<Box>
						<Button variant='primary' size='small'>
							Primary action
						</Button>
					</Box>
					<Box>
						<Button variant='secondary' size='small'>
							Secondary action
						</Button>
					</Box>
					<Box>
						<Button variant='tertiary' size='small'>
							Tertiary actions
						</Button>
					</Box>
					<Box>
						<Button variant='quaternary' size='small'>
							Quaternary
						</Button>
					</Box>
				</Inline>
				<Inline space='large'>
					<Box>
						<Button variant='primary' size='small' disabled>
							Primary action
						</Button>
					</Box>
					<Box>
						<Button variant='secondary' size='small' disabled>
							Secondary action
						</Button>
					</Box>
					<Box>
						<Button variant='tertiary' size='small' disabled>
							Tertiary actions
						</Button>
					</Box>
					<Box>
						<Button variant='quaternary' size='small' disabled>
							Quaternary action
						</Button>
					</Box>
				</Inline>
			</Stack>
			<Stack space='large'>
				<p>Normal size</p>
				<Inline space='large'>
					<Box>
						<Button variant='primary' size='normal'>
							Primary action
						</Button>
					</Box>
					<Box>
						<Button variant='secondary' size='normal'>
							Secondary action
						</Button>
					</Box>
					<Box>
						<Button variant='tertiary' size='normal'>
							Tertiary actions
						</Button>
					</Box>
					<Box>
						<Button variant='quaternary' size='normal'>
							Quaternary action
						</Button>
					</Box>
				</Inline>
				<Inline space='large'>
					<Box>
						<Button variant='primary' size='normal' disabled>
							Primary action
						</Button>
					</Box>
					<Box>
						<Button variant='secondary' size='normal' disabled>
							Secondary action
						</Button>
					</Box>
					<Box>
						<Button variant='tertiary' size='normal' disabled>
							Tertiary actions
						</Button>
					</Box>
					<Box>
						<Button variant='quaternary' size='normal' disabled>
							Quaternary action
						</Button>
					</Box>
				</Inline>
			</Stack>
			<Stack space='large'>
				<p>Large size</p>
				<Inline space='large'>
					<Box>
						<Button variant='primary' size='large'>
							Primary action
						</Button>
					</Box>
					<Box>
						<Button variant='secondary' size='large'>
							Secondary action
						</Button>
					</Box>
					<Box>
						<Button variant='tertiary' size='large'>
							Tertiary actions
						</Button>
					</Box>
					<Box>
						<Button variant='quaternary' size='large'>
							Quaternary action
						</Button>
					</Box>
				</Inline>
				<Inline space='large'>
					<Box>
						<Button variant='primary' size='large' disabled>
							Primary action
						</Button>
					</Box>
					<Box>
						<Button variant='secondary' size='large' disabled>
							Secondary action
						</Button>
					</Box>
					<Box>
						<Button variant='tertiary' size='large' disabled>
							Tertiary actions
						</Button>
					</Box>
					<Box>
						<Button variant='quaternary' size='large' disabled>
							Quaternary action
						</Button>
					</Box>
				</Inline>
			</Stack>
		</Stack>
	</Story>
</Canvas>

export function LoadingButton(props) {
	const [loading, setLoading] = useState(true)
	useEffect(() => {
		if (!loading) return undefined
		const timeout = setTimeout(() => setLoading(false), 3000)
		return () => clearTimeout(timeout)
	}, [loading])
	return (
		<Button {...props} loading={loading} onClick={() => setLoading(true)} />
	)
}

export function Template({ label, variant, tone, size }) {
	let textLabel = label
	if (label === 'Click me <em>now</em>') {
		label = (
			<>
				Click me <em>now</em>
			</>
		)
		textLabel = 'Click me now'
	}
	return (
		<Stack space='large'>
			<Heading level='2'>Loading, click to interact with</Heading>
			<Inline space='large'>
				<Stack space='large'>
					<Box maxWidth='xsmall'>
						<LoadingButton
							variant={variant}
							tone={tone}
							size={size}
						>
							{label}
						</LoadingButton>
					</Box>
					<Box maxWidth='xsmall'>
						<LoadingButton
							variant={variant}
							tone={tone}
							size={size}
							disabled
						>
							{label}
						</LoadingButton>
					</Box>
				</Stack>
				<Stack space='large'>
					<Box maxWidth='xsmall'>
						<LoadingButton
							variant={variant}
							tone={tone}
							size={size}
						>
							{label}
						</LoadingButton>
					</Box>
					<Box maxWidth='xsmall'>
						<LoadingButton
							variant={variant}
							tone={tone}
							size={size}
							disabled
						>
							{label}
						</LoadingButton>
					</Box>
				</Stack>
				<Stack space='large'>
					<Box maxWidth='xsmall'>
						<LoadingButton
							variant={variant}
							tone={tone}
							size={size}
						>
							{label}
						</LoadingButton>
					</Box>
					<Box maxWidth='xsmall'>
						<LoadingButton
							variant={variant}
							tone={tone}
							size={size}
							disabled
						>
							{label}
						</LoadingButton>
					</Box>
				</Stack>
				<Stack space='large'>
					<Box>
						<LoadingButton
							variant={variant}
							tone={tone}
							size={size}
							aria-label={textLabel}
						/>
					</Box>
					<Box>
						<LoadingButton
							variant={variant}
							tone={tone}
							size={size}
							aria-label={textLabel}
							disabled
						/>
					</Box>
				</Stack>
			</Inline>
		</Stack>
	)
}

<Canvas>
	<Story
		parameters={{ docs: { source: { type: 'code' } } }}
		argTypes={{
			label: {
				control: { type: 'select' },
				options: [
					'OK',
					'Submit',
					'Mark as done',
					'Yes, cancel my subscription',
					'Click me <em>now</em>',
					'If you click me now, youÊ¼ll take away the biggest part of me',
				],
				defaultValue: 'Submit',
			},
			variant: {
				options: ['primary', 'secondary', 'tertiary', 'quaternary'],
				control: { type: 'select' },
				defaultValue: 'primary',
			},
			tone: {
				options: ['normal', 'destructive'],
				control: { type: 'inline-radio' },
				defaultValue: 'normal',
			},
			size: {
				options: ['small', 'normal', 'large'],
				control: { type: 'inline-radio' },
				defaultValue: 'normal',
			},
			disabled: { control: false },
		}}
		name='Playground'
	>
		{Template.bind({})}
	</Story>
</Canvas>
